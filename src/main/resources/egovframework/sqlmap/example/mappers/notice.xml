<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="ants.com.admin.mapper.AdminMapper">
<!-- 	<resultMap type="ants.com.admin.model.NoticeVo" id="NoticeVo"> -->
<!-- 		<result property="noticeId" column="notice_id"/> -->
<!-- 		<result property="noticeTitle" column="notice_title"/> -->
<!-- 		<result property="noticeCont" column="notice_cont"/> -->
<!-- 		<result property="regDt" column="reg_dt"/> -->
<!-- 		<result property="adminId" column="admin_id"/> -->
<!-- 		<result property="del" column="del"/> -->
<!-- 	</resultMap> -->

	
	<!-- 공지사항 리스트 -->
	<select id="noticelist" resultType="ants.com.admin.model.NoticeVo" parameterType="ants.com.admin.model.NoticeVo">
		<!-- 
		SELECT * FROM NOTICE where del = 'N'
		order by notice_id desc 
		 -->
		
		SELECT c.*
			FROM (
				SELECT ROWNUM RNUM, a.*
				FROM (
					SELECT NOTICE_ID, NOTICE_TITLE, NOTICE_CONT, to_char(REG_DT,'YYYY-MM-DD hh24:mi') as REG_DT, ADMIN_ID, DEL
					FROM NOTICE
					WHERE DEL = 'N'
							
					<if test="searchKeyword != null and searchKeyword != ''">
						<choose>
							<when test="searchCondition == 1">
								AND notice_title LIKE '%' || #{searchKeyword} || '%'
							</when>
						</choose>
					</if>
					ORDER BY reg_dt desc, notice_id desc
				) a
		WHERE ROWNUM <![CDATA[ <= ]]> #{lastIndex} ) c <![CDATA[ WHERE c.RNUM > #{firstIndex}]]>
	</select>
	
	<!-- 공지사항게시글 수 조회하기 -->	
	<select id="noticePagingListCnt" parameterType="ants.com.admin.model.NoticeVo"  resultType="int">
		<!-- 
		select count(*) as totCnt
		from notice
		where del = 'N'
		
		<if test="searchKeyword != null and searchKeyword != ''">
		        <choose>
		            <when test="searchCondition == 1">
						AND	admin_id LIKE '%' || #{searchKeyword} || '%'
					</when>
		            <when test="searchCondition == 2">
						AND	notice_title LIKE '%' || #{searchKeyword} || '%'
					</when>
		            <when test="searchCondition == 3">
						AND	notice_cont LIKE '%' || #{searchKeyword} || '%'
					</when>
				</choose>
			</if>
			
		 
		SELECT COUNT(*)
		  FROM NOTICE
		   -->
		select count(*) as totCnt
		from notice
		WHERE DEL = 'N'
		<if test="searchKeyword != null and searchKeyword != ''">
			<choose>
				<when test="searchCondition == 1">
					AND notice_title LIKE '%' || #{searchKeyword} || '%'
				</when>
			</choose>
		</if>
	</select>
	
	<!-- 각 공지사항게시글 내용 가져오기 -->
	<select id="geteachnotice"  resultType ="ants.com.admin.model.NoticeVo" parameterType="String">
			
			SELECT notice_id, notice_title, notice_cont, to_char(REG_DT,'YYYY-MM-DD hh24:mi') as REG_DT,
					admin_id, del
			FROM notice
			WHERE notice_id = #{noticeId} and del = 'N'

	</select>
		
	<!-- 공지사항 작성하기 -->
	<insert id="insertnotice" parameterType="ants.com.admin.model.NoticeVo">
		
		INSERT INTO notice (
		    notice_id, notice_title, notice_cont,  reg_dt,  
		    admin_id, del
		) VALUES (
		    NOTICE_SEQ.nextval, #{noticeTitle}, #{noticeCont}, sysdate, 
		     #{adminId}, 'N'
		)
		
	</insert>
	
	<!-- 공지사항 수정하기 -->
	<update id="updatenotice" parameterType="ants.com.admin.model.NoticeVo">
		UPDATE NOTICE
		SET
			NOTICE_TITLE = #{noticeTitle},
			NOTICE_CONT = #{noticeCont}
	    WHERE 
	    	NOTICE_ID = #{noticeId}
	</update>
	
	
	<!-- 공지사항 삭제하기 -->
	<update id="delnotice" parameterType="ants.com.admin.model.NoticeVo"> 
		UPDATE notice 
			set del = 'Y' 
		where notice_id = #{noticeId}
	</update>




</mapper>