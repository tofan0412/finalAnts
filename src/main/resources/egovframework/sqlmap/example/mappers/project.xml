<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="ants.com.member.mapper.ProjectMapper">


	<select id="memInProjectList" parameterType="String"
		resultType="ants.com.member.model.ProjectVo">
		SELECT
		project.req_id, project.mem_id, project.pro_name,
		project.pro_percent, project.reg_dt
		FROM(select * from project)project,
		projectmember projectmember
		WHERE
		projectmember.req_id = project.req_id
		and projectmember.mem_id = #{memId}
	</select>

	<select id="plInProjectList" parameterType="String"
		resultType="ants.com.member.model.ProjectVo">
		SELECT
		DISTINCT project.req_id, project.pro_name,
		project.mem_id,
		project.pro_percent, project.reg_dt
		FROM(select * from
		project)project,
		reqlist reqlist
		WHERE
		reqlist.req_id = project.req_id
		AND reqlist.pl_id= #{memId}
	</select>

	<select id="pmInProjectList" parameterType="String"
		resultType="ants.com.member.model.ProjectVo">
		SELECT
		DISTINCT project.req_id, project.pro_name,
		project.mem_id,
		project.pro_percent, project.reg_dt
		FROM(select * from
		project)project,
		reqlist reqlist
		WHERE
		reqlist.req_id = project.req_id
		AND reqlist.mem_id= #{memId}
	</select>

	<select id="readReqList"
		resultType="ants.com.member.model.ReqVo"
		parameterType="java.lang.String">
		SELECT *
          FROM REQLIST
         WHERE REQ_ID IN (SELECT REQ_ID
                            FROM REQLIST
                           WHERE PL_ID = #{plId}
                             AND STATUS = 'WAIT')
            OR REQ_ID IN (SELECT REQ_ID
                            FROM REQLIST
                           WHERE PL_ID = #{plId}
                             AND STATUS = 'ACCEPT'
                             AND REQ_ID NOT IN (SELECT REQ_ID FROM PROJECT))
	</select>

	<insert id="insertProject"
		parameterType="ants.com.member.model.ProjectVo">
		INSERT INTO PROJECT (REQ_ID,MEM_ID,PRO_NAME,REG_DT)
		VALUES (#{reqId},#{memId,jdbcType=VARCHAR},#{proName,jdbcType=VARCHAR},SYSDATE)
	</insert>
	
	<select id="userSearch" parameterType="java.lang.String"
		resultType="ants.com.member.model.MemberVo">
		SELECT * FROM MEMBER WHERE MEM_ID LIKE #{keyword}
	</select>
	
	<select id="chkMemId" parameterType="java.lang.String" resultType="ants.com.member.model.MemberVo">
SELECT *
		  FROM MEMBER
		 WHERE MEM_ID = #{memId}
</select>
	
<insert id="insertPjtMember" parameterType="ants.com.member.model.ProjectMemberVo">
	INSERT INTO PROJECTMEMBER (req_id, promem_id, mem_id, promem_status) 
	VALUES (#{reqId}, PROMEM_SEQ.NEXTVAL, #{memId},#{promemStatus})
	
</insert>
</mapper>