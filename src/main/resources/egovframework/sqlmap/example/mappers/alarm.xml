<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="ants.com.common.mapper.AlarmMapper">

	<select id="alarmCount" resultType="ants.com.common.model.AlarmVo" parameterType="ants.com.common.model.AlarmVo">
		SELECT 
		    COUNT(CASE WHEN alarm_type='req-pl' THEN 1 END) as reqPl,
		    COUNT(CASE WHEN alarm_type='res-pl' THEN 1 END) as resPl,
		    COUNT(CASE WHEN alarm_type='reply' THEN 1 END) as reply,
		    COUNT(CASE WHEN alarm_type='posts' THEN 1 END) as posts,
		    COUNT(*) as totalCnt
		FROM alarm
		WHERE mem_id = #{memId}
		AND UPPER(alarm_status) = 'N'
	</select>
	
	<insert id="alarmInsert" parameterType="ants.com.common.model.AlarmVo">
		INSERT INTO alarm (
		    alarm_id,
		    alarm_cont,
		    alarm_status,
		    mem_id,
		    alarm_type
		)
		VALUES (
		    alarm_seq.nextval,
		    #{alarmCont},
		    'N',
		    #{memId},
		    #{alarmType}
		)
	</insert>

</mapper>